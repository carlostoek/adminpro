---
phase: 07-admin-menu-content-management
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [bot/services/message/admin_content.py, bot/services/message/__init__.py]
autonomous: true

must_haves:
  truths:
    - "Admin abre menÃº principal y ve opciÃ³n 'Paquetes de Contenido'"
    - "Admin navega a menÃº de contenido con botones de acciÃ³n"
    - "Mensajes del menÃº usan voz de Lucien consistente"
  artifacts:
    - path: "bot/services/message/admin_content.py"
      provides: "AdminContentMessages provider with content menu messages"
      min_lines: 150
      exports: ["content_menu", "content_list", "content_detail", "content_create", "content_edit", "content_confirm"]
  key_links:
    - from: "bot/handlers/admin/content.py"
      to: "bot/services/message/admin_content.py"
      via: "ServiceContainer.message.admin.content property"
      pattern: "container\\.message\\.admin\\.content\\."
---

<objective>
Create AdminContentMessages message provider with Lucien's voice for all content management UI messages (menu, list, detail, creation wizard, edit prompts, confirmations).

Purpose: Centralize all content admin messages following established message provider pattern (AdminMainMessages, UserMenuProvider) to ensure consistency with Lucien's sophisticated butler voice across the admin interface.
Output: AdminContentMessages class with 6+ message methods returning (text, keyboard) tuples in HTML format.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-admin-menu-content-management/07-CONTEXT.md
@.planning/phases/07-admin-menu-content-management/07-RESEARCH.md

@bot/services/message/admin_main.py
@bot/services/message/base.py
@bot/services/message/user_menu.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AdminContentMessages provider class</name>
  <files>bot/services/message/admin_content.py</files>
  <action>
Create AdminContentMessages class extending BaseMessageProvider following admin_main.py pattern:

1. Class structure:
   - Extends BaseMessageProvider (stateless, template-based)
   - Constructor accepts no parameters (follows existing pattern)
   - All methods return (text: str, keyboard: InlineKeyboardMarkup) tuples

2. Required methods (minimum):
   - content_menu() â†’ Main content management menu with [List Packages] [Create Package] [Back]
   - content_list_empty() â†’ Message when no packages exist
   - content_list_header() â†’ Header for package list (e.g., "ğŸ“¦ Paquetes de Contenido")
   - package_summary(package: ContentPackage) â†’ Format single package for list view
   - package_detail(package: ContentPackage) â†’ Full package details with [Edit] [Deactivate] [Back] buttons
   - create_welcome() â†’ Wizard start message "â• Crear Nuevo Paquete"
   - create_step_name() â†’ "Paso 1/4: Nombre del Paquete"
   - create_step_type() â†’ "Paso 2/4: Tipo de Contenido" with inline buttons
   - create_step_price() â†’ "Paso 3/4: Precio (opcional, enviar /skip para omitir)"
   - create_step_description() â†’ "Paso 4/4: DescripciÃ³n (opcional, enviar /skip para omitir)"
   - create_success(package: ContentPackage) â†’ Confirmation with [View] [Create Another] [Main Menu]
   - edit_prompt(field_name: str, current_value: Any) â†’ "âœï¸ Editar {field}"
   - deactivate_confirm(package: ContentPackage) â†’ "Deactivate [Package Name]? [Yes] [No]"
   - reactivate_confirm(package: ContentPackage) â†’ "Reactivate [Package Name]? [Yes] [No]"
   - toggle_success(package: ContentPackage) â†’ Success message after toggle

3. Lucien's voice requirements:
   - Tone: Sophisticated butler, formal yet approachable Spanish
   - Vocabulary: "Paquetes de Contenido" (not "packages"), "Crear" (not "add"), "Desactivar" (not "delete")
   - Emojis: ğŸ“¦ for packages, âœï¸ for edit, ğŸš« for inactive, âœ… for active
   - Weighted variations: 70% formal, 30% slightly warmer for admin (less formal than user-facing)

4. Keyboard integration:
   - Use create_inline_keyboard() from bot.utils.keyboards
   - Follow callback pattern: admin:content:list, admin:content:create, admin:content:view:{id}
   - Include navigation: Back to admin:main, Exit with menu:exit

DO NOT:
- Add database queries in message provider (stateless - data passed as parameters)
- Create FSM states (handlers manage state)
- Use hardcoded InlineKeyboardBuilder (use create_inline_keyboard helper)
- Add session/bot to __init__ (follow BaseMessageProvider stateless pattern)
  </action>
  <verify>
1. File exists: bot/services/message/admin_content.py
2. Class AdminContentMessages extends BaseMessageProvider
3. Has 15+ message methods (list above)
4. All methods return (text, keyboard) tuples
5. Uses create_inline_keyboard() for all keyboard creation
6. No database queries or session injection
7. Lucien's Spanish terminology used throughout (paquete, crear, desactivar)
  </verify>
  <done>
AdminContentMessages class created with all content UI messages, following BaseMessageProvider pattern, ready for handler integration.
  </done>
</task>

<task type="auto">
  <name>Task 2: Register AdminContentMessages in ServiceContainer</name>
  <files>bot/services/message/__init__.py</files>
  <action>
Update bot/services/message/__init__.py to register AdminContentMessages:

1. Import AdminContentMessages:
   from bot.services.message.admin_content import AdminContentMessages

2. In MessageProviderFactory._create_admin_providers() method:
   - Add instantiation: admin_content = AdminContentMessages()
   - Return in providers dict with key "admin_content"

3. In MessageProviderFactory property (admin.content):
   - Add @property lazy loading method following admin.main pattern
   - Return self._providers["admin"]["admin_content"]

Pattern reference (from admin_main.py):
```python
@property
def main(self) -> AdminMainMessages:
    """Admin main menu messages."""
    return self._providers["admin"]["admin_main"]
```

DO NOT:
- Modify other providers (admin_main, admin_vip, admin_free)
- Add database queries or state to AdminContentMessages instantiation
- Change MessageProviderFactory constructor signature
  </action>
  <verify>
1. AdminContentMessages imported in __init__.py
2. Registered in _create_admin_providers()
3. ServiceContainer.message.admin.content property exists
4. Returns AdminContentMessages instance
5. Follows existing admin provider pattern (main, vip, free)
  </verify>
  <done>
AdminContentMessages registered in ServiceContainer, accessible via container.message.admin.content, ready for handler usage.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add content menu button to admin main menu</name>
  <files>bot/services/message/admin_main.py</files>
  <action>
Update admin_main.py to include "Paquetes de Contenido" button in main menu:

1. In admin_menu_greeting() method:
   - Add button to keyboard: [{"text": "ğŸ“¦ Paquetes de Contenido", "callback_data": "admin:content"}]
   - Position: After existing buttons (ConfiguraciÃ³n, EstadÃ­sticas, etc.)
   - Order: Logical grouping with other management features

2. Verify button placement:
   - Should appear in main admin menu when configured=True
   - Should follow existing button format (emoji + Spanish text)
   - Should use admin:content callback pattern (consistent with admin:config, admin:vip, etc.)

DO NOT:
- Remove or modify existing menu buttons
- Change the callback pattern format
- Add duplicate buttons
  </action>
  <verify>
1. "ğŸ“¦ Paquetes de Contenido" button appears in admin_menu_greeting() keyboard
2. Button uses callback_data "admin:content"
3. Button placement is logical (not first, not last - grouped with management features)
4. Existing menu buttons unchanged
  </verify>
  <done>
Content menu button added to admin main menu, enabling navigation to content management interface.
  </done>
</task>

</tasks>

<verification>
Overall phase verification:
1. AdminContentMessages class exists with 15+ message methods
2. Registered in ServiceContainer.message.admin.content
3. "ğŸ“¦ Paquetes de Contenido" button appears in admin main menu
4. All messages use Lucien's Spanish terminology and voice
5. All keyboards follow admin:content:* callback pattern
6. No database queries in message provider (stateless)
7. Follows BaseMessageProvider pattern consistently
</verification>

<success_criteria>
1. Admin can open /admin and see "ğŸ“¦ Paquetes de Contenido" button
2. Clicking button navigates to content menu (callback handler to be added in plan 02)
3. All message methods return valid (text, keyboard) tuples
4. ServiceContainer can access message provider via container.message.admin.content
5. Messages use consistent Lucien voice (formal butler, Spanish terminology)
</success_criteria>

<output>
After completion, create `.planning/phases/07-admin-menu-content-management/07-01-SUMMARY.md`
</output>
