---
phase: 24-admin-configuration
plan: 08
type: execute
wave: 1
depends_on: []
files_modified:
  - bot/services/message/admin_main.py
autonomous: true
gap_closure: true

must_haves:
  truths:
    - Admin main menu displays "ğŸ“Š MÃ©tricas EconomÃ­a" button
    - Button callback routes to admin:economy_stats
    - Handler in economy_stats.py receives the callback
  artifacts:
    - path: "bot/services/message/admin_main.py"
      provides: "Economy stats menu button"
      pattern: "admin:economy_stats"
  key_links:
    - from: "_admin_main_menu_keyboard"
      to: "economy_stats_router"
      via: "callback_data='admin:economy_stats'"
---

<objective>
Add missing Economy Stats button to admin main menu.

Purpose: The economy_stats.py handler exists and works, but the button to access it is missing from the admin main menu keyboard. Admin cannot access economy metrics.

Output: Added button in _admin_main_menu_keyboard method.
</objective>

<execution_context>
@/data/data/com.termux/files/home/.claude/get-shit-done/workflows/execute-plan.md
@/data/data/com.termux/files/home/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/24-admin-configuration/24-UAT.md
@bot/services/message/admin_main.py
@bot/handlers/admin/economy_stats.py
@bot/handlers/admin/menu.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Economy Stats button to admin menu</name>
  <files>bot/services/message/admin_main.py</files>
  <action>
Add the missing "ğŸ“Š MÃ©tricas EconomÃ­a" button to the _admin_main_menu_keyboard method in bot/services/message/admin_main.py.

Current keyboard (lines 233-246):
```python
return create_inline_keyboard([
    [{"text": "ğŸ“Š Dashboard Completo", "callback_data": "admin:dashboard"}],
    [{"text": "ğŸ‘‘ CÃ­rculo Exclusivo VIP", "callback_data": "admin:vip"}],
    [{"text": "ğŸ“º VestÃ­bulo de Acceso", "callback_data": "admin:free"}],
    [{"text": "ğŸ“¦ Paquetes de Contenido", "callback_data": "admin:content"}],
    [{"text": "ğŸ›ï¸ Tienda", "callback_data": "admin:shop"}],
    [{"text": "ğŸ† Recompensas", "callback_data": "admin:rewards"}],
    [{"text": "ğŸ”” Intereses", "callback_data": "admin:interests"}],
    [{"text": "ğŸ‘¥ GestiÃ³n de Usuarios", "callback_data": "admin:users"}],
    [{"text": "ğŸ‘¤ Buscar Usuario", "callback_data": "admin:user:lookup"}],
    [{"text": "âš™ï¸ CalibraciÃ³n del Reino", "callback_data": "admin:config"}],
    [{"text": "ğŸ’° Planes de SuscripciÃ³n", "callback_data": "admin:pricing"}],
    [{"text": "ğŸ“ˆ Observaciones del Reino", "callback_data": "admin:stats"}],
])
```

Add the button after "ğŸ“ˆ Observaciones del Reino" or in a logical position. The handler in economy_stats.py expects callback_data="admin:economy_stats".

Updated keyboard:
```python
return create_inline_keyboard([
    [{"text": "ğŸ“Š Dashboard Completo", "callback_data": "admin:dashboard"}],
    [{"text": "ğŸ‘‘ CÃ­rculo Exclusivo VIP", "callback_data": "admin:vip"}],
    [{"text": "ğŸ“º VestÃ­bulo de Acceso", "callback_data": "admin:free"}],
    [{"text": "ğŸ“¦ Paquetes de Contenido", "callback_data": "admin:content"}],
    [{"text": "ğŸ›ï¸ Tienda", "callback_data": "admin:shop"}],
    [{"text": "ğŸ† Recompensas", "callback_data": "admin:rewards"}],
    [{"text": "ğŸ”” Intereses", "callback_data": "admin:interests"}],
    [{"text": "ğŸ‘¥ GestiÃ³n de Usuarios", "callback_data": "admin:users"}],
    [{"text": "ğŸ‘¤ Buscar Usuario", "callback_data": "admin:user:lookup"}],
    [{"text": "âš™ï¸ CalibraciÃ³n del Reino", "callback_data": "admin:config"}],
    [{"text": "ğŸ’° Planes de SuscripciÃ³n", "callback_data": "admin:pricing"}],
    [{"text": "ğŸ“ˆ Observaciones del Reino", "callback_data": "admin:stats"}],
    [{"text": "ğŸ“Š MÃ©tricas EconomÃ­a", "callback_data": "admin:economy_stats"}],  # NEW
])
```

Note: The button already exists in bot/handlers/admin/menu.py (line 49) but that menu is not the one being used. The active menu is generated by AdminMainMessages._admin_main_menu_keyboard().
  </action>
  <verify>
grep -n "admin:economy_stats" bot/services/message/admin_main.py
  </verify>
  <done>Economy stats button added to _admin_main_menu_keyboard</done>
</task>

</tasks>

<verification>
1. Button text is "ğŸ“Š MÃ©tricas EconomÃ­a"
2. Callback data is "admin:economy_stats"
3. Button appears in the returned keyboard list
4. Handler in economy_stats.py uses same callback_data
</verification>

<success_criteria>
- Admin sees "ğŸ“Š MÃ©tricas EconomÃ­a" button in main menu
- Clicking button triggers economy_stats handler
- Economy stats dashboard displays correctly
</success_criteria>

<output>
After completion, create `.planning/phases/24-admin-configuration/24-08-SUMMARY.md`
</output>
